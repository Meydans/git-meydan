<!DOCTYPE html>
<html lang="he" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××ª×›× ×Ÿ ×—×•×¤×©×•×ª 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Assistant', sans-serif;
            background-color: #f8fafc;
        }

        .month-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .card-anim {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-anim:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }

        @media print {
            .no-print {
                display: none;
            }

            .card-print {
                border: 1px solid #e2e8f0 !important;
                box-shadow: none !important;
            }
        }

        .calendar-grid div {
            aspect-ratio: 1;
        }
    </style>
</head>

<body class="min-h-screen bg-slate-50 text-slate-800 antialiased p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="flex flex-col md:flex-row md:items-center justify-between gap-6 mb-12 no-print">
            <div class="flex items-center gap-4">
                <div
                    class="w-16 h-16 bg-indigo-600 rounded-2xl flex items-center justify-center text-3xl shadow-lg shadow-indigo-200">
                    âœˆï¸
                </div>
                <div>
                    <h1 class="text-4xl font-black tracking-tight text-slate-900">××ª×›× ×Ÿ ×—×•×¤×©×•×ª 2026</h1>
                    <p class="text-slate-500 font-bold">×”× ×™×”×•×œ ×”×—×›× ×©×œ ×™××™ ×”×—×•×¤×© ×©×œ×š</p>
                </div>
            </div>

            <div class="flex flex-wrap items-center gap-3">
                <a href="school_holidays.html"
                    class="px-4 py-2 bg-white text-indigo-600 border border-indigo-200 rounded-lg font-bold hover:bg-indigo-50 transition shadow-sm flex items-center gap-2">
                    ğŸ“… ×œ×•×— ×—×•×¤×©×•×ª ××œ×
                </a>
                <button onclick="exportData()"
                    class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition shadow-md">
                    ğŸ“¥ ×©××™×¨×”
                </button>
                <input type="file" id="importInput" class="hidden" onchange="importData(event)">
                <button onclick="document.getElementById('importInput').click()"
                    class="px-4 py-2 bg-white text-indigo-600 border border-indigo-200 rounded-lg font-bold hover:bg-indigo-50 transition">
                    ğŸ“¤ ×˜×¢×™× ×”
                </button>
                <button onclick="resetData()"
                    class="px-4 py-2 bg-rose-50 text-rose-600 border border-rose-200 rounded-lg font-bold hover:bg-rose-100 transition"
                    title="××™×¤×•×¡ × ×ª×•× ×™×">
                    ğŸ”„
                </button>
            </div>
        </header>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-12">
            <div class="bg-white p-6 rounded-3xl border-b-8 border-emerald-600 shadow-xl shadow-emerald-900/5">
                <div class="text-slate-400 text-[10px] font-black uppercase tracking-widest mb-1">×—×•×¤×©×” ××”×¢×‘×•×“×” (× ×˜×•)
                </div>
                <div class="flex items-baseline gap-2">
                    <span id="totalWorkNet" class="text-4xl font-black text-emerald-700 tracking-tighter">0</span>
                    <span class="text-slate-400 text-sm font-bold">×™××™×</span>
                </div>
                <div class="text-[9px] text-slate-400 font-bold mt-2">×™××™ ×¢×‘×•×“×” ×‘×¤×•×¢×œ ×©× ×—×¡×›×•</div>
            </div>

            <div class="bg-white p-6 rounded-3xl border-b-8 border-emerald-300 shadow-xl shadow-emerald-900/5">
                <div class="text-slate-400 text-[10px] font-black uppercase tracking-widest mb-1">×—×•×¤×©×” ××”×¢×‘×•×“×” (×‘×¨×•×˜×•)
                </div>
                <div class="flex items-baseline gap-2">
                    <span id="totalWorkGross" class="text-4xl font-black text-emerald-500 tracking-tighter">0</span>
                    <span class="text-slate-400 text-sm font-bold">×™××™×</span>
                </div>
                <div class="text-[9px] text-slate-400 font-bold mt-2">×›×•×œ×œ ×—×’×™× ×•×¡×•×¤×™ ×©×‘×•×¢</div>
            </div>

            <div class="bg-white p-6 rounded-3xl border-b-8 border-indigo-500 shadow-xl shadow-indigo-900/5">
                <div class="text-slate-400 text-[10px] font-black uppercase tracking-widest mb-1">×—×•×¤×© ××”××¡×’×¨×•×ª</div>
                <div class="flex items-baseline gap-2">
                    <span id="totalSchoolDays" class="text-4xl font-black text-indigo-700 tracking-tighter">0</span>
                    <span class="text-slate-400 text-sm font-bold">×™××™×</span>
                </div>
            </div>

            <div class="bg-white p-6 rounded-3xl border-b-8 border-orange-500 shadow-xl shadow-orange-900/5">
                <div class="text-slate-400 text-[10px] font-black uppercase tracking-widest mb-1">×™××™ ×§×™×™×˜× ×”</div>
                <div class="flex items-baseline gap-2">
                    <span id="totalCampDays" class="text-4xl font-black text-orange-700 tracking-tighter">0</span>
                    <span class="text-slate-400 text-sm font-bold">×™××™×</span>
                </div>
            </div>

            <div class="bg-white p-6 rounded-3xl border-b-8 border-rose-500 shadow-xl shadow-rose-900/5">
                <div class="text-slate-400 text-[10px] font-black uppercase tracking-widest mb-1">×”×—×•×¤×©×” ×”×‘××”</div>
                <div id="nextVacation" class="text-sm font-black text-slate-800 truncate mt-2">×˜×¨× × ×§×‘×¢</div>
                <div id="completedMonths" class="text-[9px] text-rose-600 font-black mt-1">0 / 12 ×—×•×“×©×™×</div>
            </div>
        </div>

        <main id="appContent" class="month-grid"></main>
    </div>

    <!-- Modal -->
    <div id="monthModal"
        class="fixed inset-0 bg-slate-900/50 hidden items-center justify-center p-4 z-50 backdrop-blur-md transition-opacity">
        <div
            class="bg-white rounded-3xl shadow-2xl w-full max-w-5xl p-6 md:p-8 max-h-[95vh] overflow-y-auto border border-white/20">
            <div
                class="flex justify-between items-center mb-6 sticky top-0 bg-white/90 backdrop-blur-md z-10 py-2 border-b border-slate-100">
                <h2 id="modalTitle" class="text-3xl font-black text-slate-900"></h2>
                <button onclick="closeMonthView()"
                    class="w-10 h-10 flex items-center justify-center rounded-full bg-slate-100 hover:bg-rose-50 hover:text-rose-600 transition-all font-bold">âœ•</button>
            </div>

            <div class="grid grid-cols-7 gap-2 text-center font-black text-slate-300 mb-4 select-none">
                <div>×</div>
                <div>×‘</div>
                <div>×’</div>
                <div>×“</div>
                <div>×”</div>
                <div class="text-rose-200">×•</div>
                <div class="text-rose-200">×©</div>
            </div>

            <div id="calendarGrid" class="grid grid-cols-7 gap-2 select-none" onmousedown="startSelection(event)"
                onmouseover="updateSelection(event)" onmouseup="endSelection(event)"></div>

            <div id="batchEdit"
                class="mt-8 p-6 bg-indigo-50/50 rounded-2xl border border-indigo-100 hidden animate-in slide-in-from-bottom-2">
                <div class="flex flex-wrap items-center justify-between gap-4">
                    <div class="flex items-center gap-3">
                        <div
                            class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white text-xl">
                            âœï¸</div>
                        <div>
                            <div class="text-xs font-black text-indigo-900 uppercase">×¢×¨×™×›×” ××”×™×¨×”</div>
                            <div class="text-sm font-bold text-indigo-600">
                                × ×‘×—×¨×• <span id="selectedCount" class="font-black">0</span> ×™××™×
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center gap-3">
                        <select id="batchType"
                            class="text-sm p-3 rounded-xl border border-indigo-200 outline-none focus:ring-4 focus:ring-indigo-500/10 font-bold bg-white min-w-[140px]">
                            <option value="none">ğŸ”„ ×œ×œ× ×—×•×¤×©</option>
                            <option value="work">ğŸ’¼ ×—×•×¤×©×ª ×¢×‘×•×“×”</option>
                            <option value="school">ğŸ’ ×—×•×¤×©×” ××¡×’×¨×•×ª</option>
                            <option value="camp">â›º ×™×•× ×§×™×™×˜× ×”</option>
                        </select>
                        <select id="batchValue"
                            class="text-sm p-3 rounded-xl border border-indigo-200 outline-none focus:ring-4 focus:ring-indigo-500/10 font-bold bg-white">
                            <option value="1">×™×•× ××œ× (1)</option>
                            <option value="0.5">×—×¦×™ ×™×•× (0.5)</option>
                        </select>
                        <button onclick="applyBatchEdit()"
                            class="bg-indigo-600 text-white px-8 py-3 rounded-xl font-black hover:bg-indigo-700 transition shadow-lg shadow-indigo-600/20">×”×—×œ
                            ×©×™× ×•×™×™×</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectionStart = null;
        let selectedDays = new Set();
        let isSelecting = false;
        let currentMonthIdx = null;

        const PAID_HOLIDAYS_2026 = {
            3: { 1: { title: "×¢×¨×‘ ×¤×¡×—", type: "paid_eve", value: 0.5 }, 2: { title: "×¤×¡×— (×—×’)", type: "paid_hag", value: 1.0 }, 7: { title: "×¢×¨×‘ ×—×’ ×©× ×™", type: "paid_eve", value: 0.5 }, 8: { title: "×©×‘×™×¢×™ ×©×œ ×¤×¡×—", type: "paid_hag", value: 1.0 }, 21: { title: "×¢×¨×‘ ×™×•× ×”×¢×¦×××•×ª", type: "paid_eve", value: 0.5 }, 22: { title: "×™×•× ×”×¢×¦×××•×ª", type: "paid_hag", value: 1.0 } },
            4: { 21: { title: "×¢×¨×‘ ×©×‘×•×¢×•×ª", type: "paid_eve", value: 0.5 }, 22: { title: "×©×‘×•×¢×•×ª", type: "paid_hag", value: 1.0 } },
            8: { 11: { title: "×¢×¨×‘ ×¨××© ×”×©× ×”", type: "paid_eve", value: 0.5 }, 12: { title: "×¨××© ×”×©× ×”", type: "paid_hag", value: 1.0 }, 13: { title: "×¨××© ×”×©× ×”", type: "paid_hag", value: 1.0 }, 20: { title: "×¢×¨×‘ ×™×•× ×›×™×¤×•×¨", type: "paid_eve", value: 0.5 }, 21: { title: "×™×•× ×›×™×¤×•×¨", type: "paid_hag", value: 1.0 }, 25: { title: "×¢×¨×‘ ×¡×•×›×•×ª", type: "paid_eve", value: 0.5 }, 26: { title: "×¡×•×›×•×ª", type: "paid_hag", value: 1.0 } },
            9: { 2: { title: "×¢×¨×‘ ×©××—×ª ×ª×•×¨×”", type: "paid_eve", value: 0.5 }, 3: { title: "×©××—×ª ×ª×•×¨×”", type: "paid_hag", value: 1.0 } }
        };

        const HOLIDAYS_2026 = {
            2: { 1: { title: "×—×•×¤×©×ª ×¤×•×¨×™×", type: "school" }, 2: { title: "×—×•×¤×©×ª ×¤×•×¨×™×", type: "school" }, 3: { title: "×¤×•×¨×™×", type: "holiday" } },
            3: {
                1: { title: "×¢×¨×‘ ×¤×¡×—", type: "eve" }, 2: { title: "×¤×¡×— (×—×’)", type: "holiday" }, 3: { title: "×—×•×œ ×”××•×¢×“", type: "holiday" }, 4: { title: "×—×•×œ ×”××•×¢×“", type: "holiday" }, 5: { title: "×—×•×œ ×”××•×¢×“", type: "holiday" }, 6: { title: "×—×•×œ ×”××•×¢×“", type: "holiday" }, 7: { title: "×¢×¨×‘ ×—×’ ×©× ×™", type: "eve" }, 8: { title: "×©×‘×™×¢×™ ×©×œ ×¤×¡×—", type: "holiday" }, 21: { title: "×¢×¨×‘ ×™×•× ×”×¢×¦×××•×ª", type: "eve" }, 22: { title: "×™×•× ×”×¢×¦×××•×ª", type: "holiday" },
                ...Array.from({ length: 10 }, (_, i) => i + 1).reduce((acc, d) => ({ ...acc, [d]: { title: "×—×•×¤×©×ª ×¤×¡×—", type: "school" } }), {})
            },
            4: { 5: { title: "×œ\"×’ ×‘×¢×•××¨", type: "school" }, 21: { title: "×¢×¨×‘ ×©×‘×•×¢×•×ª", type: "eve" }, 22: { title: "×©×‘×•×¢×•×ª", type: "holiday" }, 20: { title: "××¡×¨×• ×—×’", type: "school" }, 21: { title: "×¢×¨×‘ ×©×‘×•×¢×•×ª", type: "school" }, 22: { title: "×©×‘×•×¢×•×ª", type: "school" }, 23: { title: "××¡×¨×• ×—×’", type: "school" } },
            6: { ...Array.from({ length: 31 }, (_, i) => i + 1).reduce((acc, d) => ({ ...acc, [d]: { title: "×—×•×¤×© ×’×“×•×œ", type: "school" } }), {}) },
            7: { ...Array.from({ length: 31 }, (_, i) => i + 1).reduce((acc, d) => ({ ...acc, [d]: { title: "×—×•×¤×© ×’×“×•×œ", type: "school" } }), {}) },
            8: { 11: { title: "×¢×¨×‘ ×¨×”\"×©", type: "school" }, 12: { title: "×¨××© ×”×©× ×”", type: "school" }, 13: { title: "×¨××© ×”×©× ×”", type: "school" }, 20: { title: "×¢×¨×‘ ×™×•\"×›", type: "school" }, 21: { title: "×™×•× ×›×™×¤×•×¨", type: "school" }, ...Array.from({ length: 6 }, (_, i) => i + 25).reduce((acc, d) => ({ ...acc, [d]: { title: "×—×•×¤×©×ª ×¡×•×›×•×ª", type: "school" } }), {}) },
            9: { 1: { title: "×—×•×¤×©×ª ×¡×•×›×•×ª", type: "school" }, 2: { title: "×—×•×¤×©×ª ×¡×•×›×•×ª", type: "school" }, 3: { title: "×—×•×¤×©×ª ×¡×•×›×•×ª", type: "school" }, 4: { title: "××¡×¨×• ×—×’", type: "school" } },
            11: { ...Array.from({ length: 7 }, (_, i) => i + 4).reduce((acc, d) => ({ ...acc, [d]: { title: "×—×•×¤×©×ª ×—× ×•×›×”", type: "school" } }), {}) }
        };

        function getPaidHoliday(mIdx, day) {
            return (PAID_HOLIDAYS_2026[mIdx] || {})[day] || null;
        }

        function getMonthData(mIdx) { return HOLIDAYS_2026[mIdx] || {}; }

        const defaultState = ["×™× ×•××¨", "×¤×‘×¨×•××¨", "××¨×¥", "××¤×¨×™×œ", "×××™", "×™×•× ×™", "×™×•×œ×™", "××•×’×•×¡×˜", "×¡×¤×˜××‘×¨", "××•×§×˜×•×‘×¨", "× ×•×‘××‘×¨", "×“×¦××‘×¨"].map(m => ({
            month: m, goal: "", note: "", done: false, userDays: {}
        }));

        let state = JSON.parse(localStorage.getItem('vacation_plan_2026_v2')) || JSON.parse(JSON.stringify(defaultState));
        state = state.map(m => ({ userDays: {}, ...m }));

        function openMonthView(mIdx) {
            currentMonthIdx = mIdx;
            const m = state[mIdx];
            document.getElementById('modalTitle').innerText = m.month + ' 2026';
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';

            const startDay = new Date(2026, mIdx, 1).getDay();
            const daysInMonth = new Date(2026, mIdx + 1, 0).getDate();
            const holidays = getMonthData(mIdx);

            for (let i = 0; i < startDay; i++) grid.innerHTML += '<div></div>';

            for (let d = 1; d <= daysInMonth; d++) {
                const holiday = holidays[d];
                const paid = getPaidHoliday(mIdx, d);
                const userDay = m.userDays[d] || { type: 'none', value: 0 };
                const date = new Date(2026, mIdx, d);
                const isWeekend = date.getDay() === 5 || date.getDay() === 6;

                let classes = "p-2 rounded-2xl border border-slate-100 flex flex-col items-start gap-1 relative transition-all hover:border-indigo-200 group cursor-pointer bg-white shadow-sm min-h-[100px]";
                let dayContent = `<span class="text-xs font-black text-slate-400">${d}</span>`;

                if (isWeekend) classes += " bg-rose-50/20";

                if (userDay.type !== 'none') {
                    const colors = { school: 'indigo', work: 'emerald', camp: 'orange' };
                    const labels = { school: '××¡×’×¨×ª', work: '×¢×‘×•×“×”', camp: '×§×™×™×˜× ×”' };
                    const c = colors[userDay.type];
                    classes += ` ring-2 ring-${c}-400 bg-${c}-50`;
                    dayContent += `<span class="text-[9px] font-black text-${c}-700 bg-white px-1.5 py-0.5 rounded-lg border border-${c}-100 w-full truncate">${labels[userDay.type]} (${userDay.value})</span>`;
                } else if (paid) {
                    classes += " ring-2 ring-amber-400 bg-amber-50";
                    dayContent += `<span class="text-[9px] font-black text-amber-700 bg-white px-1.5 py-0.5 rounded-lg border border-amber-100 w-full truncate">×—×•×¤×©×” ×‘×ª×©×œ×•×</span>`;
                    dayContent += `<span class="text-[8px] font-bold text-amber-600/70 truncate w-full">${paid.title}</span>`;
                } else if (holiday) {
                    const c = holiday.type === 'school' ? 'indigo' : 'rose';
                    dayContent += `<span class="text-[8px] font-bold text-${c}-600/70 bg-${c}-50/50 p-1 rounded-md w-full truncate">${holiday.title}</span>`;
                }

                grid.innerHTML += `<div class="${classes}" data-day="${d}">${dayContent}</div>`;
            }
            document.getElementById('monthModal').classList.remove('hidden');
            document.getElementById('monthModal').classList.add('flex');
        }

        function closeMonthView() {
            document.getElementById('monthModal').classList.add('hidden');
            document.getElementById('monthModal').classList.remove('flex');
            selectedDays.clear();
            document.getElementById('batchEdit').classList.add('hidden');
        }

        function startSelection(e) {
            const cell = e.target.closest('[data-day]');
            if (!cell) return;
            isSelecting = true;
            selectionStart = parseInt(cell.dataset.day);
            selectedDays.clear();
            selectedDays.add(selectionStart);
            updateSelectionUI();
        }

        function updateSelection(e) {
            if (!isSelecting) return;
            const cell = e.target.closest('[data-day]');
            if (!cell) return;
            const current = parseInt(cell.dataset.day);
            const start = Math.min(selectionStart, current);
            const end = Math.max(selectionStart, current);
            selectedDays.clear();
            for (let i = start; i <= end; i++) selectedDays.add(i);
            updateSelectionUI();
        }

        function endSelection() {
            isSelecting = false;
            if (selectedDays.size > 0) {
                document.getElementById('batchEdit').classList.remove('hidden');
                document.getElementById('selectedCount').innerText = selectedDays.size;
            }
        }

        function updateSelectionUI() {
            document.querySelectorAll('[data-day]').forEach(cell => {
                const day = parseInt(cell.dataset.day);
                if (selectedDays.has(day)) cell.classList.add('scale-95', 'opacity-80', 'ring-indigo-600');
                else cell.classList.remove('scale-95', 'opacity-80', 'ring-indigo-600');
            });
        }

        function applyBatchEdit() {
            const type = document.getElementById('batchType').value;
            const value = parseFloat(document.getElementById('batchValue').value);
            selectedDays.forEach(day => {
                if (type === 'none') delete state[currentMonthIdx].userDays[day];
                else state[currentMonthIdx].userDays[day] = { type, value };
            });
            render();
            openMonthView(currentMonthIdx);
        }

        function render() {
            const container = document.getElementById('appContent');
            container.innerHTML = '';
            let tNet = 0, tGross = 0, tSchool = 0, tCamp = 0, completed = 0;

            state.forEach((m, idx) => {
                if (m.done) completed++;
                let mNet = 0, mGross = 0, mSchool = 0, mCamp = 0;
                const days = new Date(2026, idx + 1, 0).getDate();

                for (let d = 1; d <= days; d++) {
                    const date = new Date(2026, idx, d);
                    const isWE = date.getDay() === 5 || date.getDay() === 6;
                    const u = m.userDays[d];
                    const p = getPaidHoliday(idx, d);

                    if (u) {
                        if (u.type === 'work') {
                            mGross += u.value;
                            if (!isWE) mNet += u.value;
                        }
                        if (u.type === 'school' && !isWE) mSchool += u.value;
                        if (u.type === 'camp' && !isWE) mCamp += u.value;
                    } else if (p) {
                        mGross += p.value;
                        if (!isWE) { mNet += p.value; mSchool += p.value; }
                    }
                }

                tNet += mNet; tGross += mGross; tSchool += mSchool; tCamp += mCamp;

                const card = document.createElement('div');
                card.className = `p-6 rounded-3xl border-2 border-slate-200 bg-white hover:border-indigo-300 card-anim ${m.done ? 'opacity-50 grayscale' : ''} relative overflow-hidden`;
                card.innerHTML = `
                    <div class="flex justify-between items-start mb-6">
                        <h3 class="text-3xl font-black text-slate-900">${m.month}</h3>
                        <div class="flex gap-2">
                            <button onclick="openMonthView(${idx})" class="w-10 h-10 rounded-xl bg-slate-50 flex items-center justify-center text-xl hover:bg-white hover:shadow-lg transition">â†—</button>
                            <input type="checkbox" ${m.done ? 'checked' : ''} onchange="updateItem(${idx}, 'done', this.checked)" class="w-6 h-6 accent-emerald-500 rounded-lg">
                        </div>
                    </div>
                    <div class="space-y-4">
                        <input type="text" value="${m.goal}" onchange="updateItem(${idx}, 'goal', this.value)" class="w-full bg-slate-50 p-3 rounded-xl font-bold text-slate-700 outline-none border-2 border-transparent focus:border-indigo-100" placeholder="××” ×”××˜×¨×”?">
                        <div class="grid grid-cols-3 gap-2 text-center">
                            <div class="bg-emerald-50 p-2 rounded-2xl border border-emerald-100">
                                <div class="text-[7px] font-black text-emerald-600 uppercase">×¢×‘×•×“×” (× ×˜×•/×‘×¨×•×˜×•)</div>
                                <div class="text-sm font-black text-emerald-700">${mNet} / ${mGross}</div>
                            </div>
                            <div class="bg-indigo-50 p-2 rounded-2xl border border-indigo-100">
                                <div class="text-[7px] font-black text-indigo-600 uppercase">××¡×’×¨×•×ª</div>
                                <div class="text-sm font-black text-indigo-700">${mSchool}</div>
                            </div>
                            <div class="bg-orange-50 p-2 rounded-2xl border border-orange-100">
                                <div class="text-[7px] font-black text-orange-600 uppercase">×§×™×™×˜× ×”</div>
                                <div class="text-sm font-black text-orange-700">${mCamp}</div>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });

            document.getElementById('totalWorkNet').innerText = tNet;
            document.getElementById('totalWorkGross').innerText = tGross;
            document.getElementById('totalSchoolDays').innerText = tSchool;
            document.getElementById('totalCampDays').innerText = tCamp;
            document.getElementById('completedMonths').innerText = `${completed} / 12 ×—×•×“×©×™×`;
            const next = state.find(m => !m.done && m.goal);
            document.getElementById('nextVacation').innerText = next ? `${next.month}: ${next.goal}` : '××™×Ÿ ×—×•×¤×©×” ×§×¨×•×‘×”';
            localStorage.setItem('vacation_plan_2026_v2', JSON.stringify(state));
        }

        function updateItem(idx, f, v) { state[idx][f] = v; render(); }
        function resetData() { if (confirm('×œ××¤×¡ ×”×›×œ?')) { localStorage.removeItem('vacation_plan_2026_v2'); state = JSON.parse(JSON.stringify(defaultState)); render(); } }
        function exportData() { const blob = new Blob([JSON.stringify(state)], { type: 'application/json' }); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'vacation_2026.json'; a.click(); }
        function importData(e) { const fr = new FileReader(); fr.onload = (x) => { state = JSON.parse(x.target.result); render(); }; fr.readAsText(e.target.files[0]); }

        render();
    </script>
</body>

</html>